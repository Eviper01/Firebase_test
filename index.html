<!DOCTYPE html>


<html lang="en">
 <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">     
     
<!--//jQeury\\-->    
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>     
    
<!--//Bootstrap\\--> 
    
 <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!--sliders-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.8.1/bootstrap-slider.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.8.1/css/bootstrap-slider.min.css">

     
<!--//Firebase\\-->  
<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-database.js"></script>
     
     
    

</head>    
    

<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyCPZUB3Nb-CSBkGVM5kF8wvVnU1EFwfuQg",
    authDomain: "test-data-9865f.firebaseapp.com",
    databaseURL: "https://test-data-9865f.firebaseio.com",
    projectId: "test-data-9865f",
    storageBucket: "test-data-9865f.appspot.com",
    messagingSenderId: "962467111816"
  };
  firebase.initializeApp(config);

  var database = firebase.database();

</script>



<body>
<title>Test Data</title> 
    
<div class="container">
    <h2 id="User">Please sign in</h2>

  <input id="txtEmail" type="email" class="form-control" placeholder="Email">
  <input id="txtPassword" type="password" class="form-control" placeholder="Password">
  <button id="btnLogin" class="btn btn-primary">Log in</button>
  <button id="btnSignUp" class="btn btn-default">Sign Up</button>
  <button id="btnLogout" class="btn btn-danger hide pull-right">Logout</button>
</div>

    

    
    
<div class="container hide" id="database">
    <pre id="data"></pre>
   <!-- <input id="txtKey" type="text" class="form-control" placeholder="key">
    <input id="txtValue" type="text" class="form-control" placeholder="value">-->
    <input id="ex8" data-slider-id='ex1Slider' type="text" data-slider-min="15" data-slider-max="35" data-slider-step="1" data-slider-value="20"/>
   <!-- <button id="btnAdd" class="btn btn-primary">Add Data</button>
    <button id="btnDel" class="btn btn-danger">Delete Data</button> -->
    </div>
    
    

        



<script>
//UI
const txtEmail = document.getElementById('txtEmail');
const txtPassword = document.getElementById('txtPassword');
const btnLogin = document.getElementById('btnLogin');
const btnSignUp = document.getElementById('btnSignUp');
const btnLogout = document.getElementById('btnLogout');
    
const divDatabase = document.getElementById('database');

const txtKey = document.getElementById('txtKey');
const txtValue = document.getElementById('txtValue');
const btnAdd = document.getElementById('btnAdd');
const btnDel = document.getElementById('btnDel');
    
var User = document.getElementById('User');
    
//functions
    
function writeData(key,value) {
    var keyData = {
         [key] : value };

    
    database.ref().child('users').child(firebase.auth().currentUser.uid).update(keyData);
    
    
};
//Listners
    
$("#ex8").slider({
	tooltip: 'show'
});    

//button event listners

btnLogin.addEventListener('click', e => {
console.log("sucess");    
const email = txtEmail.value;
const pass = txtPassword.value;
const promise = firebase.auth().signInWithEmailAndPassword(email,pass);
console.log(promise.uid);
promise.catch(e => console.log(e.message));
});

btnSignUp.addEventListener('click', e => {
const email = txtEmail.value;
const pass = txtPassword.value;
const promise = firebase.auth().createUserWithEmailAndPassword(email,pass);
promise.catch(e => console.log(e.message));
});

btnLogout.addEventListener('click', e => {
  firebase.auth().signOut();
});
    
btnAdd.addEventListener('click', e => {
    const key = txtKey.value;
    const value = txtValue.value;
    writeData(key,value);
});

btnDel.addEventListener('click', e=> {
    const key = txtKey.value;
    const value = null;
    writeData(key,value);
                        });


// Login Listener

firebase.auth().onAuthStateChanged(firebaseUser => {
  if(firebaseUser) {
    console.log(firebaseUser);
    btnLogout.classList.remove('hide');
    divDatabase.classList.remove('hide');
      txtEmail.classList.add('hide');
      txtPassword.classList.add('hide');
      btnLogin.classList.add('hide');
      btnSignUp.classList.add('hide');
    User.innerText = firebaseUser.email;
      refBase = database.ref().child('users').child(firebase.auth().currentUser.uid);
      refBase.on('value' , snap => element.innerText = JSON.stringify(snap.val(),null,3));
    
  } else {
    console.log("Logged Out");
   btnLogout.classList.add('hide');
    divDatabase.classList.add('hide');
      
    txtEmail.classList.remove('hide');
      txtPassword.classList.remove('hide');
      btnLogin.classList.remove('hide');
      btnSignUp.classList.remove('hide');
      User.innerText = "Please sign in";
  }
})



//Reading data from database to webpage    
    
var element = document.getElementById("data");
</script>    
    

</body>

</html>
